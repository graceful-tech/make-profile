<div class="wrapper">
  <div class="grid">
    <div class="col-12 md:col-6 lg:col-3">
      <div class="mb-2 back-button">
        <button type="button" class="back-btn" (click)="goBack()"><i class="fa fa-arrow-left"></i> Back</button>
      </div>
    </div>
  </div>
  <div class="profile-wrapper">
    <Header>
      <div class="header-image">
        <h5>Choose Your Existing Template</h5>
      </div>
    </Header>
  </div>

  <div class="table-container">
    <p-table class="mobile" [value]="availableCredits">
      <ng-template pTemplate="header">
        <tr>
          <th style="max-width: 5%">TEMPLATE NAME</th>
          <th style="max-width: 5%">NICK NAME</th>
          <th style="max-width: 5%">GENERATE RESUME</th>
          <th style="max-width: 5%">EDIT</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-credits let-rowIndex="rowIndex">
        <tr *ngIf="!dataLoaded">
          <td>
            <p-skeleton styleClass="mb-2" height="1rem"></p-skeleton>
          </td>
          <td>
            <p-skeleton styleClass="mb-2" height="1rem"></p-skeleton>
          </td>
          <td>
            <p-skeleton styleClass="mb-2" height="1rem"></p-skeleton>
          </td>
          <td>
            <p-skeleton styleClass="mb-2" height="1rem"></p-skeleton>
          </td>
        </tr>

        <tr *ngIf="dataLoaded">
          <td>
            <span>{{ credits.templateName }}</span>
          </td>

          <td>
            <ng-container *ngIf="editingRow === rowIndex; else showNickName">
              <input
                type="text"
                [(ngModel)]="editedNickName"
                class="p-inputtext p-component"
              />

              <span style="display: inline-flex; gap: 8px">
                <button
                  style="
                    padding: 3px 5px;
                    border: none;
                    border-radius: 7px;
                    background: rgb(21, 154, 21);
                    color: white;
                  "
                  (click)="updateNickName(credits, credits.id)"
                >
                  Save
                </button>
                <button
                  style="
                    padding: 3px 5px;
                    border: none;
                    border-radius: 7px;
                    background: rgb(98, 102, 98);
                    color: white;
                  "
                  (click)="cancelEdit()"
                >
                  Cancel
                </button>
              </span>
            </ng-container>
            <ng-template #showNickName>
              {{ credits.nickName }}
            </ng-template>
          </td>
          <ng-container
            *ngIf="credits.templateName !== 'Applied Job'; else emptyCell"
          >
            <td>
              <button
                type="button"
                class="modify-btn"
                (click)="navigateToVerify(credits.templateName)"
              >
                Generate Resume
              </button>
            </td>
          </ng-container>
          <ng-template #emptyCell>
            <td></td>
          </ng-template>
          <td>
            <button
              type="button"
              class="edit-nick"
              *ngIf="editingRow !== rowIndex"
              (click)="editNickName(rowIndex, credits)"
            >
              Edit NickName
            </button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5">No records found.</td>
        </tr>
      </ng-template>
    </p-table>
    <div class="pagination-wrapper">
      <p-paginator
        (onPageChange)="onPageChangeTemplate($event)"
        [totalRecords]="totalRecords"
        [rowsPerPageOptions]="[5]"
        [rows]="maxLimitPerPageForResume"
      >
      </p-paginator>
    </div>
  </div>
</div>
